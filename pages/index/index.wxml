<!--pages/index/index.wxml-->
<loading content="{{loadContent}}"></loading>
<inform content="{{informContent}}"></inform>

<!-- 左侧选择栏出现时的背景 -->
<view class="coverBackground" hidden="{{!(leftOptionsFlag)}}"></view>

<view class="left {{leftOptionsFlag?'left_show':''}}" bindtouchend="controlLeftOptions">
  <view class="left_container">
    <view class="left_top">
      <image src='{{user.avatarUrl}}' class="user_icon"></image>
      <view class="user_nu">
        {{user.un}}
      </view>
    </view>
    
    <view class="left_option" bindtap="reachTo" data-target="我的森林">我的森林</view>
    <view class="left_option" bindtap="reachTo" data-target="我的好友">我的好友</view>
    <view class="left_option" bindtap="reachTo" data-target="目标历程">目标历程</view>
    <view class="left_option" bindtap="reachTo" data-target="最新消息">最新消息</view>
    <view class="left_option" bindtap="reachTo" data-target="商城">商城</view>
    <view class="left_option" bindtap="reachTo" data-target="设置">设置</view>
    <view class="left_option" bindtap="reachTo" data-target="更多">更多</view>
  </view>
</view>

<view class="top">
  <view class="options" bindtap="controlLeftOptions">
    <view class="line"></view>
    <view class="line"></view>
    <view class="line"></view>
  </view>
</view>

<view class="main">
  <view class="containerOfProgress">
    <image src="images/book.png" class="progress_icon"></image>
    <progress active percent="{{currentTarget.progress}}" activeColor="rgb(212, 212, 79)" stroke-width="35rpx" border-radius="20rpx" backgroundColor="white"/>
  </view>

  <view class="tree_container">
    <!-- 动画显示的树木 -->
    <image class="tree" src="{{currentTarget.tree}}" style="height:{{treeHeight}}; opacity:{{treeOpacity}}" animation="{{treeAnimation}}" hidden="{{treeShow}}"></image>
    <!-- 动画结束后显示的固定树木 -->
    <image class="tree" src="{{currentTarget.tree}}" hidden="{{!treeShow}}"></image>
    <image class="solid" src="images/solid.png"></image>
  </view>
  <view class="target_title">{{currentTarget.title}}</view>
  <view class="button" bindtap="record">打卡</view>
</view>

<!-- 选择树苗 -->
<view class="chooseTreeContainer" wx:if="{{addTargetFlag}}" bindtap="addTarget">
  <view class="chooseTree" catchtap>
    <view class="chooseTreeTop">选择树苗</view>
    <view class="treeOptions">
      <image class="treeOption" wx:for="{{userTrees}}" src="{{item.path[0]}}" wx:key="tree" bindtap="chooseTree" data-treeid="{{item._id}}"></image>
    </view>
  </view>
</view>

<target id="target" class="bottom" bindchoose="chooseTarget" catchadd="addTarget"></target>
